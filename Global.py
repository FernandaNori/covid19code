# -*- coding: utf-8 -*-
"""Projeto- automatização de dados global

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/11sTT-hBKb5ZR2s7tQhI11rAtg2Z3vphg
"""

import pandas as pd
import requests

url = 'https://raw.githubusercontent.com/microsoft/Bing-COVID-19-Data/master/data/Bing-COVID19-Data.csv'
dataset = pd.read_csv(url)

#Trocar os campos nulos por zero
dataset = dataset.fillna(0) 
#Excluir as linhas Worldwide e estados
dataset = dataset.drop(dataset[dataset.Country_Region == 'Worldwide'].index)
dataset = dataset.drop(dataset[dataset.AdminRegion1 != 0].index)
dataset.reset_index(drop=True, inplace=True)
#Excluir colunas
dataset = dataset[['Updated', 'Confirmed', 'ConfirmedChange', 'Deaths',
       'DeathsChange', 'Recovered', 'RecoveredChange', 'Country_Region']]
dtest = dataset
dataset['pais_ingles'] = dataset['Country_Region']
#Datas
dataset['pais_ingles'] = dataset['Country_Region']
datas = list(dataset["Updated"])
novas_datas = []
for dia in datas:
  dia = dia.split("/")
  dia = f'{dia[1]}/{dia[0]}/{dia[2]}'
  novas_datas.append(dia)
#tradução dos nomes dos países
countries = ["Afghanistan" ,"South Africa" ,"Albania" ,"Germany" ,"Andorra" ,"Angola" ,"Antigua and Barbuda" ,"Saudi Arabia" ,"Algeria" ,"Argentina" ,"Armenia" ,"Australia" ,"Austria" ,"Azerbaijan" ,"The Bahamas" ,"Bangladesh" ,"Barbados" ,"Bahrain" ,"Belgium" ,"Belize" ,"Benin" ,"Belarus" ,"Bolivia" ,"Bosnia; Bosnia and Herzegovina" ,"Botswana" ,"Brazil" ,"Brunei" ,"Bulgaria" ,"Burkina Faso" ,"Burundi" ,"Bhutan" ,"Cape Verde" ,"Cameroon" ,"Cambodia" ,"Canada" ,"Qatar" ,"Kazakhstan" ,"Central African Republic" ,"Chad" ,"Czech Republic" ,"Chile" ,"China" ,"Cyprus" ,"Singapore" ,"Colombia" ,"Comoros" ,"Congo, Democratic Republic of the" ,"Congo, Republic of the" ,"North Korea" ,"South Korea" ,"Ivory Coast; Côte d’Ivoire" ,"Costa Rica" ,"Croatia" ,"Cuba" ,"Denmark" ,"Djibouti" ,"Dominica" ,"Dominican Republic" ,"Egypt" ,"El Salvador" ,"United Arab Emirates" ,"Ecuador" ,"Eritrea" ,"Scotland" ,"Slovakia" ,"Slovenia" ,"Spain" ,"United States" ,"Estonia" ,"Ethiopia" ,"Fiji" ,"Philippines" ,"Finland" ,"France" ,"Gabon" ,"Gambia, The" ,"Ghana" ,"Georgia" ,"Grenada" ,"Greece" ,"Guatemala" ,"Guyana" ,"Guinea" ,"Guinea-Bissau" ,"Equatorial Guinea" ,"Haiti" ,"Holland" ,"Honduras" ,"Hungary" ,"Yemen" ,"India" ,"Indonesia" ,"England" ,"Iran" ,"Iraq" ,"Ireland" ,"Iceland" ,"Israel" ,"Italy" ,"Jamaica" ,"Japan" ,"Jordan" ,"Kuwait" ,"Laos" ,"Lesotho" ,"Latvia" ,"Lebanon" ,"Liberia" ,"Libya" ,"Liechtenstein" ,"Lithuania" ,"Luxembourg" ,"Macedonia" ,"Madagascar" ,"Malaysia" ,"Malawi" ,"Maldives" ,"Mali" ,"Malta" ,"Morocco" ,"Mauritius" ,"Mauritania" ,"Mexico" ,"Micronesia, Federated States of" ,"Mozambique" ,"Moldova" ,"Monaco" ,"Mongolia" ,"Montenegro" ,"Burma; Myanmar" ,"Namibia" ,"Nauru" ,"Nepal" ,"Nicaragua" ,"Niger" ,"Nigeria" ,"Norway" ,"New Zealand" ,"Oman" ,"Wales" ,"Palestine" ,"Panama" ,"Papua New Guinea" ,"Pakistan" ,"Paraguay" ,"Peru" ,"Poland" ,"Portugal" ,"Kenya" ,"Kyrgyzstan" ,"Kiribati" ,"United Kingdom" ,"Romania" ,"Rwanda" ,"Russia" ,"Solomon Islands" ,"Samoa" ,"Saint Lucia" ,"Saint Kitts and Nevis" ,"San Marino" ,"São Tomé and Príncipe" ,"Saint Vincent and the Grenadines" ,"Seychelles" ,"Senegal" ,"Sierra Leone" ,"Serbia" ,"Syria" ,"Somalia" ,"Sri Lanka" ,"Swaziland" ,"Sudan" ,"South Sudan" ,"Sweden" ,"Switzerland" ,"Suriname" ,"Tajikistan" ,"Thailand" ,"Tanzania" ,"Czech Republic" ,"East Timor" ,"Togo" ,"Tonga" ,"Trinidad and Tobago" ,"Turkmenistan" ,"Turkey" ,"Ukraine" ,"Uganda" ,"Uruguay" ,"Uzbekistan" ,"Vanuatu" ,"Vatican City" ,"Venezuela" ,"Vietnam" ,"Zambia" ,"Zimbabwe","Worldwide" ,"American Samoa" ,"Anguilla" ,"Aruba" ,"Bahamas" ,"Bermuda" ,"Bonaire" ,"Bosnia and Herzegovina" ,"British Virgin Islands" ,"Cabo Verde" ,"Cayman Islands" ,"China (mainland)" ,"Congo" ,"Congo (DRC)" ,"Côte d'Ivoire" ,"Curacao" ,"Curaçao" ,"Czechia" ,"Eswatini" ,"Falkland Islands" ,"Faroe Islands" ,"French Guiana" ,"French Polynesia" ,"French-Guadeloupe" ,"French-Martinique" ,"Gambia" ,"Gaza Strip" ,"Gibraltar" ,"Greenland" ,"Guadeloupe" ,"Guam" ,"Guernsey" ,"Hong Kong SAR" ,"Isle of Man" ,"Jersey" ,"Kosovo" ,"Macao SAR" ,"Martinique" ,"Mayotte" ,"Montserrat" ,"Myanmar" ,"Netherlands" ,"New Caledonia" ,"North Macedonia" ,"Northern Mariana Islands" ,"Puerto Rico" ,"Réunion" ,"Saba" ,"Saint Barthelemy" ,"Saint Barthélemy" ,"Saint Martin" ,"Saint Pierre and Miquelon" ,"St Kitts and Nevis" ,"St Marten" ,"St Vincent and the Grenadines" ,"Taiwan" ,"The Gambia" ,"Timor-Leste" ,"Tunisia" ,"Turks and Caicos Islands" ,"U.S. Virgin Islands" ,"US Virgin Islands" ,"West Bank"]
paises = ["Afeganistão" ,"África do Sul" ,"Albânia" ,"Alemanha" ,"Andorra" ,"Angola" ,"Antígua e Barbuda" ,"Arábia Saudita" ,"Argélia" ,"Argentina" ,"Armênia" ,"Austrália" ,"Áustria" ,"Azerbaijão" ,"Bahamas" ,"Bangladesh" ,"Barbados" ,"Bahrein" ,"Bélgica" ,"Belize" ,"Benin" ,"Bielorrússia" ,"Bolívia" ,"Bósnia e Herzegovina" ,"Botsuana" ,"Brasil" ,"Brunei" ,"Bulgária" ,"Burkina Faso" ,"Burundi" ,"Butão" ,"Cabo Verde" ,"Camarões" ,"Camboja" ,"Canadá" ,"Catar" ,"Cazaquistão" ,"República Centro-Africana" ,"Chade" ,"República Tcheca" ,"Chile" ,"China" ,"Chipre" ,"Cingapura" ,"Colômbia" ,"Comores" ,"República Democrática do Congo" ,"República do Congo" ,"Coreia do Norte" ,"Coreia do Sul" ,"Costa do Marfim" ,"Costa Rica" ,"Croácia" ,"Cuba" ,"Dinamarca" ,"Djibuti" ,"Dominica" ,"República Dominicana" ,"Egito" ,"El Salvador" ,"Emirados Árabes Unidos" ,"Equador" ,"Eritreia" ,"Escócia" ,"Eslováquia" ,"Eslovênia" ,"Espanha" ,"Estados Unidos" ,"Estônia" ,"Etiópia" ,"Fiji" ,"Filipinas" ,"Finlândia" ,"França" ,"Gabão" ,"Gâmbia" ,"Gana" ,"Geórgia" ,"Granada" ,"Grécia" ,"Guatemala" ,"Guiana" ,"Guiné" ,"Guiné-Bissau" ,"Guiné Equatorial" ,"Haiti" ,"Holanda" ,"Honduras" ,"Hungria" ,"Iêmen" ,"Índia" ,"Indonésia" ,"Inglaterra" ,"Irã" ,"Iraque" ,"Irlanda" ,"Islândia" ,"Israel" ,"Itália" ,"Jamaica" ,"Japão" ,"Jordânia" ,"Kuaite" ,"Laos" ,"Lesoto" ,"Letônia" ,"Líbano" ,"Libéria" ,"Líbia" ,"Liechtenstein" ,"Lituânia" ,"Luxemburgo" ,"Macedônia" ,"Madagascar" ,"Malásia" ,"Malawi" ,"Maldivas" ,"Máli" ,"Malta" ,"Marrocos" ,"Maurício" ,"Mauritânia" ,"México" ,"Estados Federados da Micronésia" ,"Moçambique" ,"Moldávia" ,"Mônaco" ,"Mongólia" ,"Montenegro" ,"Myanmar" ,"Namíbia" ,"Nauru" ,"Nepal" ,"Nicarágua" ,"Níger" ,"Nigéria" ,"Noruega" ,"Nova Zelândia" ,"Omã" ,"País de Gales" ,"Palestina" ,"Panamá" ,"Papua Nova Guiné" ,"Paquistão" ,"Paraguai" ,"Peru" ,"Polônia" ,"Portugal" ,"Quênia" ,"Quirguizistão" ,"Quiribáti" ,"Reino Unido" ,"Romênia" ,"Ruanda" ,"Rússia" ,"Ilhas Salomão" ,"Samoa" ,"Santa Lúcia" ,"São Cristóvão e Neves" ,"São Marino" ,"São Tomé e Príncipe" ,"São Vicente e Granadinas" ,"Seychelles" ,"Senegal" ,"Serra Leoa" ,"Sérvia" ,"Síria" ,"Somália" ,"Sri Lanka" ,"Suazilândia" ,"Sudão" ,"Sudão do Sul" ,"Suécia" ,"Suíça" ,"Suriname" ,"Tadjiquistão" ,"Tailândia" ,"Tanzânia" ," República Checa" ,"Timor Leste" ,"Togo" ,"Tonga" ,"Trinidad e Tobago" ,"Turcomenistão" ,"Turquia" ,"Ucrânia" ,"Uganda" ,"Uruguai" ,"Uzbequistão" ,"Vanuatu" ,"Vaticano" ,"Venezuela" ,"Vietnã" ,"Zâmbia" ,"Zimbábue" ,"Ao Redor Do Mundo" ,"Samoa Americana" ,"Anguilla" ,"Aruba" ,"Bahamas" ,"Bermuda" ,"Bonaire" ,"Bósnia e Herzegovina" ,"Ilhas Virgens Britânicas" ,"Cabo Verde" ,"Ilhas Cayman" ,"China" ,"Congo" ,"República Democrática do Congo" ,"Costa do Marfim" ,"Curaçao" ,"Curaçao" ,"República Tcheca" ,"Essuatíni" ,"Ilhas Malvinas" ,"Ilhas Faroé" ,"Guiana Francesa" ,"Polinésia Francesa" ,"Guadaloupe Francesa" ,"Martinica Francesa" ,"Gâmbia" ,"Faixa de Gaza" ,"Gibraltar" ,"Groenlândia" ,"Guadaloupe" ,"Guam" ,"Guernsey" ,"Hong Kong" ,"Ilha de Man" ,"Jersey" ,"Kosovo" ,"Macau" ,"Martinica" ,"Mayotte" ,"Montserrat" ,"Mianmar" ,"Holanda" ,"Nova Caledônia" ,"Macedônia" ,"Ilhas Marianas do Norte" ,"Porto Rico" ,"Reunião" ,"Saba" ,"São Bartolomeu" ,"São Bartolomeu" ,"Ilha de São Martin" ,"Saint-Pierre e Miquelon" ,"São Cristóvão e Névis" ,"São Martinho" ,"São Vicente e Granadinas" ,"Taiwan" ,"Gâmbia" ,"Timor Leste" ,"Tunísia" ,"Ilhas Turcas e Caicos" ,"Ilhas Virgens Americanas" ,"Ilhas Virgens Americanas" ,"Cisjordânia" ]
Pais = []
for i in dataset['Country_Region']:
  index = countries.index(i)
  Pais.append(paises[index])

dataset['Country_Region'] = Pais
#Acrescentar continentes
dataset["Updated"] = novas_datas
america_do_norte = ['América do Norte', 'Estados Unidos', 'Canadá', 'Groenlândia','México']
america_do_sul = ['América do Sul','Saba','Bonaire','Argentina','Aruba','Bolívia','Brasil','Chile','Colômbia','Curaçao','Equador','Guiana','Guiana Francesa','Ilhas Malvinas','Paraguai','Peru','Suriname','Trinidad e Tobago','Venezuela']
america_central = ["América Central",'Antígua e Barbuda',"Anguilla","Bahamas" ,"Barbados" ,"Benin" ,"Bermuda" ,"Brunei" ,"Catar" ,"República Centro - Africana" ,"Chade" ,"Costa do Marfim" ,"Costa Rica" ,"Dominica" ,"República Dominicana" ,"El Salvador"  ,"Granada" ,"Guadaloupe" ,"Guatemala" ,"Guiné Equatorial" ,"Haiti" ,"Honduras" ,"Hong Kong" ,"Ilha de São Martin" ,"Ilhas Cayman" ,"Ilhas Turcas e Caicos" ,"Ilhas Virgens Americanas" ,"Ilhas Virgens Britânicas" ,"Jamaica" ,"Martinica" ,"Mauritânia" ,"Nicarágua" ,"Panamá" ,"Porto Rico" ,"Saint-Pierre e Miquelon" ,"Santa Lúcia" ,"São Bartolomeu" ,"São Cristóvão e Névis" ,"saint Martin" ,"São Vicente e Granadinas" ,"Uganda" ,"Uruguai" ,"Uzbequistão" ]
asia = ["Ásia","Afeganistão",'Bahrein',"Armênia" ,"Bangladesh" ,"Bahrein","Butão" ,"Camboja" ,"Cazaquistão" ,"China" ,"Cingapura" ,"Cisjordânia" ,"Coreia do Sul" ,"Faixa de Gaza" ,"Filipinas" ,"Iêmen" ,"Índia" ,"Indonésia" ,"Irã" ,"Iraque" ,"Israel" ,"Japão" ,"Jordânia" ,"Kuaite" ,"Laos" ,"Líbano" ,"Malásia" ,"Maldivas" ,"Mianmar" ,"Mongólia" ,"Nepal" ,"Omã" ,"Paquistão" ,"Quirguizistão" ,"Rússia" ,"Síria" ,"Sri Lanka" ,"Tadjiquistão" ,"Tailândia" ,"Taiwan" ,"Timor Leste " ,"Turquia" ,"Vietnã" ]
europa = ["Europa","Albânia" ,"Alemanha","Finlândia","Andorra" ,"Arábia Saudita" ,"Áustria" ,"Azerbaijão" ,"Bélgica" ,"Belize" ,"Bielorrússia" ,"Bósnia e Herzegovina" ,"Botsuana" ,"Bulgária" ,"Chipre" ,"Croácia" ,"Cuba" ,"Dinamarca" ,"Emirados Árabes Unidos" ,"Eslováquia" ,"Eslovênia" ,"Espanha" ,"Essuatíni" ,"Estônia" ,"França" ,"Gana" ,"Geórgia" ,"Gibraltar" ,"Grécia" ,"Guernsey" ,"Holanda" ,"Hungria" ,"Ilha de Man" ,"Ilhas Faroé" ,"Irlanda" ,"Islândia" ,"Itália" ,"Jersey" ,"Kosovo" ,"Letônia" ,"Liechtenstein" ,"Lituânia" ,"Luxemburgo" ,"Macau" ,"Macedônia" ,"Malta" ,"Moldávia" ,"Mônaco" ,"Montenegro" ,"Montserrat" ,"Noruega" ,"Polônia" ,"Portugal" ,"Reino Unido" ,"República Tcheca" ,"Romênia" ,"São Marino" ,"São Tomé e Príncipe" ,"Sérvia" ,"Suécia" ,"Suíça" ,"Ucrânia" ,"Vaticano" ]
oceania = ["Oceania","Austrália",'Vanuatu',"Fiji" ,"Guadaloupe Francesa" ,"Guam" ,"Ilhas Marianas do Norte" ,"Martinica Francesa" ,"Nova Caledônia" ,"Nova Zelândia" ,"Papua Nova Guiné" ,"Polinésia Francesa" ,"Samoa Americana" ]
africa = ["África","África do Sul" ,"Angola",'São Martinho' ,"Argélia" ,"Burkina Faso",'República Centro-Africana' ,"Burundi" ,"Cabo Verde" ,"Camarões" ,"Comores" ,"Congo" ,"Djibuti" ,"Egito" ,"Eritreia" ,"Etiópia" ,"Gabão" ,"Gâmbia" ,"Guiné" ,"Guiné-Bissau" ,"Lesoto" ,"Libéria" ,"Líbia" ,"Madagascar" ,"Malawi" ,"Máli" ,"Marrocos" ,"Maurício" ,"Mayotte" ,"Moçambique" ,"Namíbia" ,"Níger" ,"Nigéria" ,"Quênia" ,"República Democrática do Congo" ,"Reunião" ,"Ruanda" ,"Seychelles" ,"Senegal" ,"Serra Leoa" ,"Somália" ,"Sudão" ,"Sudão do Sul" ,"Tanzânia" ,"Togo" ,"Tunísia" ,"Zâmbia" ,"Zimbábue" ]
Continentes = []
for i in dataset['Country_Region']:
  if i in america_do_sul:
    Continentes.append(america_do_sul[0])
  elif i in america_do_norte:
    Continentes.append(america_do_norte[0])
  elif i in asia:
    Continentes.append(asia[0])
  elif i in europa:
    Continentes.append(europa[0])
  elif i in oceania:
    Continentes.append(oceania[0])
  elif i in africa:
    Continentes.append(africa[0])
  elif i in america_central:
    Continentes.append(america_central[0])
  else:
    Continentes.append('@@@@@@')
dataset['Continente'] = Continentes


dataset[dataset['pais_ingles'] == 'Congo'].tail(50)
dataset.sample(3)

#mudando o nome das colunas 
dataset = dataset.rename(columns={'Updated':'Data', 'Confirmed':'Casos Confirmados', 'ConfirmedChange':'Novos casos', 'Deaths':'Óbitos',
       'DeathsChange':'Novos Óbitos', 'Recovered':'Recuperados', 'RecoveredChange':'Novos Recuperados', 'Country_Region':'País'})

#HOTFIX
u = "https://raw.githubusercontent.com/wcota/covid19br/master/cases-brazil-states.csv"

total = pd.read_csv(u)

total.drop(total[total.state != 'TOTAL'].index, inplace=True)

casos = total.iloc[-1][8]
mortos = total.iloc[-1][6]
recuperados = total.iloc[-1][14]
print (casos,mortos,recuperados)

index = dataset[dataset.pais_ingles == "Brazil"].index[-1]
dataset.at[index, 'Casos Confirmados'] = casos
dataset.at[index, 'Óbitos'] = mortos
dataset.at[index, 'Recuperados'] = recuperados

#substituindo valores negativos
def negativo(n):
  if n < 0:
    return 0
  return n

dataset["Casos Confirmados"] = dataset["Casos Confirmados"].apply(negativo)
dataset["Novos casos"] = dataset["Novos casos"].apply(negativo)
dataset["Óbitos"] = dataset["Óbitos"].apply(negativo)
dataset["Recuperados"] = dataset["Recuperados"].apply(negativo)
dataset["Novos Recuperados"] = dataset["Novos Recuperados"].apply(negativo)


#HOTFIX
dataset.drop_duplicates(["País"], keep="last", inplace=True)
dataset.reset_index(drop=True, inplace=True)

#Criando o arquivo
dataset.to_excel("Covid 19 - Global.xlsx", index=False)

#Função de download
from google.colab import files
files.download('Covid 19 - Global.xlsx') 

#dataset.sort_values("Novos casos").head(5)
#dataset[dataset['pais_ingles'] == 'Saint Barthélemy'].tail(50).reset_index(drop=True)


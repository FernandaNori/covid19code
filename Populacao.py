# -*- coding: utf-8 -*-
"""Projeto - Automatização População Global .ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1moZ3xivWGWGDXRnz0ftyEC9tuakOBxjr
"""

import pandas as pd
import requests

url = 'https://www.indexmundi.com/map/'
r = requests.get(url)
x = r.text.split("<table")[2].split('</table>')[0].split('<tr>')

populacao = {"pais":[],
             "populacao":[]}
for i in x:
  try:
    pa = i.split('<td>')[1].split('</td>')[0]
    po = int(i.split('<td>')[1].split('</td>')[1].split('>')[1].replace(",", ""))
    #print(pa.translate(table))
    populacao['pais'].append(pa)
    populacao['populacao'].append(po)
  except:
    pass

countries = ["Afghanistan" ,"South Africa" ,"Albania" ,"Germany" ,"Andorra" ,"Angola" ,"Antigua and Barbuda" ,"Saudi Arabia" ,"Algeria" ,"Argentina" ,"Armenia" ,"Australia" ,"Austria" ,"Azerbaijan" ,"Bahamas, The" ,"Bangladesh" ,"Barbados" ,"Bahrain" ,"Belgium" ,"Belize" ,"Benin" ,"Belarus" ,"Bolivia" ,"Bosnia; Bosnia and Herzegovina" ,"Botswana" ,"Brazil" ,"Brunei" ,"Bulgaria" ,"Burkina Faso" ,"Burundi" ,"Bhutan" ,"Cape Verde" ,"Cameroon" ,"Cambodia" ,"Canada" ,"Qatar" ,"Kazakhstan" ,"Central African Republic" ,"Chad" ,"Czech Republic" ,"Chile" ,"China" ,"Cyprus" ,"Singapore" ,"Colombia" ,"Comoros" ,"Congo, Democratic Republic of the" ,"Congo, Republic of the" ,"North Korea" ,"South Korea" ,"Ivory Coast; Côte d’Ivoire" ,"Costa Rica" ,"Croatia" ,"Cuba" ,"Denmark" ,"Djibouti" ,"Dominica" ,"Dominican Republic" ,"Egypt" ,"El Salvador" ,"United Arab Emirates" ,"Ecuador" ,"Eritrea" ,"Scotland" ,"Slovakia" ,"Slovenia" ,"Spain" ,"United States" ,"Estonia" ,"Ethiopia" ,"Fiji" ,"Philippines" ,"Finland" ,"France" ,"Gabon" ,"Gambia, The" ,"Ghana" ,"Georgia" ,"Grenada" ,"Greece" ,"Guatemala" ,"Guyana" ,"Guinea" ,"Guinea-Bissau" ,"Equatorial Guinea" ,"Haiti" ,"Holland" ,"Honduras" ,"Hungary" ,"Yemen" ,"India" ,"Indonesia" ,"England" ,"Iran" ,"Iraq" ,"Ireland" ,"Iceland" ,"Israel" ,"Italy" ,"Jamaica" ,"Japan" ,"Jordan" ,"Kuwait" ,"Laos" ,"Lesotho" ,"Latvia" ,"Lebanon" ,"Liberia" ,"Libya" ,"Liechtenstein" ,"Lithuania" ,"Luxembourg" ,"Macedonia" ,"Madagascar" ,"Malaysia" ,"Malawi" ,"Maldives" ,"Mali" ,"Malta" ,"Morocco" ,"Mauritius" ,"Mauritania" ,"Mexico" ,"Micronesia, Federated States of" ,"Mozambique" ,"Moldova" ,"Monaco" ,"Mongolia" ,"Montenegro" ,"Burma; Myanmar" ,"Namibia" ,"Nauru" ,"Nepal" ,"Nicaragua" ,"Niger" ,"Nigeria" ,"Norway" ,"New Zealand" ,"Oman" ,"Wales" ,"Palestine" ,"Panama" ,"Papua New Guinea" ,"Pakistan" ,"Paraguay" ,"Peru" ,"Poland" ,"Portugal" ,"Kenya" ,"Kyrgyzstan" ,"Kiribati" ,"United Kingdom" ,"Romania" ,"Rwanda" ,"Russia" ,"Solomon Islands" ,"Samoa" ,"Saint Lucia" ,"Saint Kitts and Nevis" ,"San Marino" ,"São Tomé and Príncipe" ,"Saint Vincent and the Grenadines" ,"Seychelles" ,"Senegal" ,"Sierra Leone" ,"Serbia" ,"Syria" ,"Somalia" ,"Sri Lanka" ,"Swaziland" ,"Sudan" ,"South Sudan" ,"Sweden" ,"Switzerland" ,"Suriname" ,"Tajikistan" ,"Thailand" ,"Tanzania" ,"Czech Republic" ,"East Timor" ,"Togo" ,"Tonga" ,"Trinidad and Tobago" ,"Turkmenistan" ,"Turkey" ,"Ukraine" ,"Uganda" ,"Uruguay" ,"Uzbekistan" ,"Vanuatu" ,"Vatican City" ,"Venezuela" ,"Vietnam" ,"Zambia" ,"Zimbabwe","Worldwide" ,"American Samoa" ,"Anguilla" ,"Aruba" ,"Bahamas" ,"Bermuda" ,"Bonaire" ,"Bosnia and Herzegovina" ,"British Virgin Islands" ,"Cabo Verde" ,"Cayman Islands" ,"China (mainland)" ,"Congo" ,"Congo (DRC)" ,"Côte d'Ivoire" ,"Curacao" ,"Curaçao" ,"Czechia" ,"Eswatini" ,"Falkland Islands" ,"Faroe Islands" ,"French Guiana" ,"French Polynesia" ,"French-Guadeloupe" ,"French-Martinique" ,"Gambia" ,"Gaza Strip" ,"Gibraltar" ,"Greenland" ,"Guadeloupe" ,"Guam" ,"Guernsey" ,"Hong Kong SAR" ,"Isle of Man" ,"Jersey" ,"Kosovo" ,"Macao SAR" ,"Martinique" ,"Mayotte" ,"Montserrat" ,"Myanmar" ,"Netherlands" ,"New Caledonia" ,"North Macedonia" ,"Northern Mariana Islands" ,"Puerto Rico" ,"Réunion" ,"Saba" ,"Saint Barthelemy" ,"Saint Barthélemy" ,"Saint Martin" ,"Saint Pierre and Miquelon" ,"St Kitts and Nevis" ,"St Marten" ,"St Vincent and the Grenadines" ,"Taiwan" ,"The Gambia" ,"Timor-Leste" ,"Tunisia" ,"Turks and Caicos Islands" ,"U.S. Virgin Islands" ,"US Virgin Islands" ,"West Bank", 'Burma', 'Korea, South', 'Cote d&#39;Ivoire', 'Korea, North', 'Hong Kong','Macau', 'Bahamas,The', 'Sao Tome and Principe', 'Palau', 'Tuvalu', 'Falkland Islands (Islas Malvinas)', 'Holy See (Vatican City)']
paises = ["Afeganistão" ,"África do Sul" ,"Albânia" ,"Alemanha" ,"Andorra" ,"Angola" ,"Antígua e Barbuda" ,"Arábia Saudita" ,"Argélia" ,"Argentina" ,"Armênia" ,"Austrália" ,"Áustria" ,"Azerbaijão" ,"Bahamas" ,"Bangladesh" ,"Barbados" ,"Bahrein" ,"Bélgica" ,"Belize" ,"Benin" ,"Bielorrússia" ,"Bolívia" ,"Bósnia e Herzegovina" ,"Botsuana" ,"Brasil" ,"Brunei" ,"Bulgária" ,"Burkina Faso" ,"Burundi" ,"Butão" ,"Cabo Verde" ,"Camarões" ,"Camboja" ,"Canadá" ,"Catar" ,"Cazaquistão" ,"República Centro-Africana" ,"Chade" ,"República Tcheca" ,"Chile" ,"China" ,"Chipre" ,"Cingapura" ,"Colômbia" ,"Comores" ,"República Democrática do Congo" ,"República do Congo" ,"Coreia do Norte" ,"Coreia do Sul" ,"Costa do Marfim" ,"Costa Rica" ,"Croácia" ,"Cuba" ,"Dinamarca" ,"Djibuti" ,"Dominica" ,"República Dominicana" ,"Egito" ,"El Salvador" ,"Emirados Árabes Unidos" ,"Equador" ,"Eritreia" ,"Escócia" ,"Eslováquia" ,"Eslovênia" ,"Espanha" ,"Estados Unidos" ,"Estônia" ,"Etiópia" ,"Fiji" ,"Filipinas" ,"Finlândia" ,"França" ,"Gabão" ,"Gâmbia" ,"Gana" ,"Geórgia" ,"Granada" ,"Grécia" ,"Guatemala" ,"Guiana" ,"Guiné" ,"Guiné-Bissau" ,"Guiné Equatorial" ,"Haiti" ,"Holanda" ,"Honduras" ,"Hungria" ,"Iêmen" ,"Índia" ,"Indonésia" ,"Inglaterra" ,"Irã" ,"Iraque" ,"Irlanda" ,"Islândia" ,"Israel" ,"Itália" ,"Jamaica" ,"Japão" ,"Jordânia" ,"Kuaite" ,"Laos" ,"Lesoto" ,"Letônia" ,"Líbano" ,"Libéria" ,"Líbia" ,"Liechtenstein" ,"Lituânia" ,"Luxemburgo" ,"Macedônia" ,"Madagascar" ,"Malásia" ,"Malawi" ,"Maldivas" ,"Máli" ,"Malta" ,"Marrocos" ,"Maurício" ,"Mauritânia" ,"México" ,"Estados Federados da Micronésia" ,"Moçambique" ,"Moldávia" ,"Mônaco" ,"Mongólia" ,"Montenegro" ,"Mianmar" ,"Namíbia" ,"Nauru" ,"Nepal" ,"Nicarágua" ,"Níger" ,"Nigéria" ,"Noruega" ,"Nova Zelândia" ,"Omã" ,"País de Gales" ,"Palestina" ,"Panamá" ,"Papua Nova Guiné" ,"Paquistão" ,"Paraguai" ,"Peru" ,"Polônia" ,"Portugal" ,"Quênia" ,"Quirguizistão" ,"Quiribáti" ,"Reino Unido" ,"Romênia" ,"Ruanda" ,"Rússia" ,"Ilhas Salomão" ,"Samoa" ,"Santa Lúcia" ,"São Cristóvão e Névis" ,"São Marino" ,"São Tomé e Príncipe" ,"São Vicente e Granadinas" ,"Seychelles" ,"Senegal" ,"Serra Leoa" ,"Sérvia" ,"Síria" ,"Somália" ,"Sri Lanka" ,"Suazilândia" ,"Sudão" ,"Sudão do Sul" ,"Suécia" ,"Suíça" ,"Suriname" ,"Tadjiquistão" ,"Tailândia" ,"Tanzânia" ," República Checa" ,"Timor Leste" ,"Togo" ,"Tonga" ,"Trinidad e Tobago" ,"Turcomenistão" ,"Turquia" ,"Ucrânia" ,"Uganda" ,"Uruguai" ,"Uzbequistão" ,"Vanuatu" ,"Vaticano" ,"Venezuela" ,"Vietnã" ,"Zâmbia" ,"Zimbábue" ,"Ao Redor Do Mundo" ,"Samoa Americana" ,"Anguilla" ,"Aruba" ,"Bahamas" ,"Bermuda" ,"Bonaire" ,"Bósnia e Herzegovina" ,"Ilhas Virgens Britânicas" ,"Cabo Verde" ,"Ilhas Cayman" ,"China" ,"Congo" ,"República Democrática do Congo" ,"Costa do Marfim" ,"Curaçao" ,"Curaçao" ,"República Tcheca" ,"Essuatíni" ,"Ilhas Malvinas" ,"Ilhas Faroé" ,"Guiana Francesa" ,"Polinésia Francesa" ,"Guadaloupe Francesa" ,"Martinica Francesa" ,"Gâmbia" ,"Faixa de Gaza" ,"Gibraltar" ,"Groenlândia" ,"Guadaloupe" ,"Guam" ,"Guernsey" ,"Hong Kong" ,"Ilha de Man" ,"Jersey" ,"Kosovo" ,"Macau" ,"Martinica" ,"Mayotte" ,"Montserrat" ,"Mianmar" ,"Holanda" ,"Nova Caledônia" ,"Macedônia" ,"Ilhas Marianas do Norte" ,"Porto Rico" ,"Reunião" ,"Saba" ,"São Bartolomeu" ,"São Bartolomeu" ,"Ilha de São Martin" ,"Saint-Pierre e Miquelon" ,"São Cristóvão e Névis" ,"São Martinho" ,"São Vicente e Granadinas" ,"Taiwan" ,"Gâmbia" ,"Timor Leste " ,"Tunísia" ,"Ilhas Turcas e Caicos" ,"Ilhas Virgens Americanas" ,"Ilhas Virgens Americanas" ,"Cisjordânia", 'Myanmar','Coreia do Sul','Costa do Marfim','Coreia do Norte','Hong Kong','Macau','Bahamas','São Tomé e Príncipe','Palau','Tuvalu','Ilhas Malvinas','Vaticano']

new_pais = []
tradu = []
for i in populacao['pais']:
  if i in countries:
    index = countries.index(i)
    new_pais.append(paises[index])
    tradu.append("@")
  else:
    new_pais.append(i)
    tradu.append("")

populacao['pais'] = new_pais
populacao['traducao'] = tradu

population = pd.DataFrame(populacao)

#Criando o arquivo
population.to_excel("Covid 19 - População Global.xlsx", index=False)

#Função de download
from google.colab import files
files.download('Covid 19 - População Global.xlsx') 

population.sample(5)

import requests
import json
import pandas as pd

u = "https://data.opendatasoft.com/api/records/1.0/search/?dataset=world-population%40kapsarc&rows=2885&facet=year&facet=country_name"

r = requests.get(u)
u = r.text

j = json.loads(u)

dat = {'pais': [],
       'value': [],
       'year': []}
for i in j['records']:
  #print(i['fields'])
  dat['pais'].append(i['fields']['country_name'])
  dat['value'].append(int(i['fields']['value']))
  dat['year'].append(i['fields']['year'])

dat = pd.DataFrame(dat).sort_values(["pais", "year"])
dat.head(50)

dat = dat.drop_duplicates(subset=["pais"], keep="last")
print(len(dat))
dat.sort_values('value', ascending=False).head(5)

